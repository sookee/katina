<!DOCTYPE HTML>
<!--
/*-----------------------------------------------------------------.
| Copyright (C) 2013 SooKee oasookee@gmail.com               |
'------------------------------------------------------------------'

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the Free Software
Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA
02110-1301, USA.

http://www.gnu.org/licenses/gpl-2.0.html

'-----------------------------------------------------------------*/
 -->
<html>
	<head>
		<script src="js/sarissa/sarissa-compressed.js"></script>
		<script src="js/sarissa/sarissa_ieemu_xpath-compressed.js"></script>
		<script src="js/jquery-1.9.1.min.js"></script>
		<script src="js/jquery.debug.js"></script>
		<script src="js/jquery.xslTransform.js"></script>
		<script src="js/rest-api.js"></script>
		<link rel="stylesheet" type="text/css" href="css/polls-table.css"/>
		<link rel="stylesheet" type="text/css" href="css/polls-sel-base.css"/>
	</head>
	<body>
		<script>
			var cserv = false;
			function injectBases()
			{
				cserv = $('#div-bases').val();
				inject(
					{
						target: '#div-bases'
						, action: injectPolls
						, params: '?func=get_bases&format=generic'
					}
					, {
						xsl: 'xsl/rest-select-asoc.xsl'
						, options: {
							id: 'sel-base'
							, prefix: 'sel-base'
						}
					}
				);
				$('#sel-serv').val(cserv);
			}
			
			function injectPolls()
			{
				injectOld({
					id: 'sel-poll'
					, xsl: 'xsl/polls-sel-poll.xsl'
					, target: '#div-polls'
					, action: injectTable
					, prefix: 'xsl-polls-sel-poll'
					, params:'?func=get_polls'
						+ '&base=' + document.getElementById('sel-base').value
				});		
			}
			
			function injectTable()
			{
				injectOld({
					id: 'sel-poll'
					, xsl: 'xsl/polls-table.xsl'
					, target: '#div-table'
//					, action: injectTable
					, prefix: 'xsl-polls-table'
					, params:'?func=get_poll'
						+ '&base=' + document.getElementById('sel-base').value
						+ '&poll=' + document.getElementById('sel-poll').value
				});		
			}
			
			$(document).ready(function() {
				injectBases();
			});
		</script>
		<div id="div-bases"></div>
		<div id="div-polls"></div>
		<div id="div-table"></div>
	</body>
</html>