<!DOCTYPE HTML>
<html>
	<head>
		<script src="js/sarissa/sarissa.js"></script>
		<script src="js/sarissa/sarissa_ieemu_xpath.js"></script>
		<script src="js/jquery-1.9.1.js"></script>
		<script src="js/jquery.xslTransform.js"></script>
		<script src="js/jquery.xslt.js"></script>
	</head>
	<body>
		<script>
			function injectBases()
			{
				var params = '?func=get_bases'
						+ '&base=' + document.getElementById('sel-bases').value
						+ '&poll=' + document.getElementById('sel-polls').value;
				
				$.xslt({
					xmlUrl: 'rest-api.php' + params
					, xslUrl: 'sel-bases.xsl'
					, callback: function(output) {
						document.getElementById('sel-bases').innerHTML = output;
						injectPolls();				
					}
				});
			}
			
			function injectPolls()
			{
				var params = '?func=get_polls'
						+ '&base=' + document.getElementById('sel-bases').value;
				
				$.xslt({
					xmlUrl: 'rest-api.php' + params
					, xslUrl: 'sel-polls.xsl'
					, xmlCache: false
					, callback: function(output) {
						document.getElementById('sel-polls').innerHTML = output;
						injectTable();
					}
				});
			}
			
			function injectTable()
			{
				var params = '?func=get_poll'
						+ '&base=' + document.getElementById('sel-bases').value
						+ '&poll=' + document.getElementById('sel-polls').value;
				
				$('#div-table').getTransform(
					'div-table.xsl'
					, 'rest-api.php' + params
				);
			}
			
			$(document).ready(function() {
				injectBases();
			});
		</script>
		<div>
			<select id="sel-bases" onChange="injectPolls();"></select> 
			<select id="sel-polls" onChange="injectTable();"></select> 
		</div>
		<div id="div-table"></div>
	</body>
</html>